// Copyright (c) 2025 Gabriel Lawrence
//
// Licensed under the MIT License. See LICENSE file in the project root for full license information.

package resources

import (
	"fmt"
)

// toolDescriptions contains all tool descriptions as Go string constants
var toolDescriptions = map[string]string{
	"auth_status": "Check authentication status including token expiry and refresh availability. Shows if you're logged in to OneNote.\n\nThe server automatically remembers your authentication across sessions - you typically only need to authenticate once. Use this tool to check if you're still authenticated or if your token has expired.\n\nRESPONSE SHOWS:\nâ€¢ authenticated: true/false\nâ€¢ token_expires: when current token expires\nâ€¢ refresh_available: if token can be refreshed without re-auth\n\nUSE WHEN: Starting work, troubleshooting access issues, or checking token status.",

	"auth_refresh": "Refresh the current authentication token to extend session without full re-authentication.\n\nThe server stores and manages tokens automatically - you rarely need this tool. Use only when auth_status shows token expiry is approaching or after receiving authentication errors.\n\nWORKFLOW:\n1. Check: auth_status â†’ shows 'expires soon' or 'expired'\n2. Refresh: auth_refresh â†’ extends token automatically\n3. Verify: auth_status â†’ confirms new expiry time\n\nNOTE: If refresh fails, use auth_initiate for full re-authentication.",

	"auth_initiate": "Start OAuth authentication flow. Returns a URL to visit in your browser to authenticate with Microsoft.\n\nâš ï¸ WHEN TO USE: Only needed for initial setup or after token revocation. Server remembers authentication across restarts - you typically authenticate once and you're done.\n\nFULL AUTHENTICATION WORKFLOW:\n1. Start server: ./onenote-mcp-server.exe\n2. Check status: auth_status â†’ shows 'not authenticated'\n3. Initiate auth: auth_initiate â†’ returns URL + instructions\n4. Visit URL in browser â†’ complete Microsoft OAuth on localhost:8080\n5. Server automatically receives callback â†’ saves tokens\n6. Verify: auth_status â†’ shows 'authenticated'\n7. Ready for all OneNote operations\n\nSUBSEQUENT STARTS: Server loads saved tokens automatically - no re-auth needed unless revoked.\n\nDEPENDENCIES: All OneNote operations require authentication. Always explain next steps to user.",

	"auth_clear": "Logout by clearing all stored authentication tokens. Forces re-authentication for future OneNote operations.\n\nâš ï¸ WARNING: This removes the server's saved authentication. After using this, you'll need auth_initiate to authenticate again.\n\nWORKFLOW:\n1. Clear tokens: auth_clear â†’ removes all stored credentials\n2. Verify logout: auth_status â†’ shows 'not authenticated'\n3. Re-authenticate: auth_initiate â†’ if you want to use OneNote again\n\nUSE WHEN: Security concerns, switching Microsoft accounts, or troubleshooting authentication issues.",

	"notebooks": "List all OneNote notebooks accessible to the authenticated user. Returns notebook ID, name, and default status flags as a JSON array.\n\nğŸ  ESSENTIAL STARTING POINT: Always start here when users ask \"Show me my notebooks\" or need to work with any notebook. This is the ID discovery tool.\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ notebooks() â†’ find notebook by name â†’ notebook_select(ID) â†’ sections() â†’ pages(sectionID)\nâ€¢ notebooks() provides IDs needed for ALL other operations\nâ€¢ Users think in names, but API requires IDs - this tool translates\n\nğŸ“ TYPICAL WORKFLOWS:\nâ€¢ 'Show my notebooks' â†’ notebooks() â†’ display list with names and IDs\nâ€¢ 'Work with X notebook' â†’ notebooks() â†’ find X â†’ notebook_select(X_ID) â†’ sections()\nâ€¢ 'Create page in Y notebook' â†’ notebooks() â†’ find Y â†’ notebook_select(Y_ID) â†’ sections() â†’ page_create(sectionID)\n\nğŸ“Š RESPONSE FORMAT - JSON array with:\nâ€¢ id: Notebook ID for API operations (e.g., \"1-abc123...\")\nâ€¢ name: Display name (e.g., \"Work Notebook\")\nâ€¢ isAPIDefault: OneNote's default per Microsoft Graph API\nâ€¢ isConfigDefault: Matches server's configured default\nâ€¢ permission: Access level (read/write) if authorization enabled\nâ€¢ canSelect: Whether user can select this notebook\n\nâš¡ ALWAYS EXPLAIN RESULTS: \"I found your 'Work' notebook (ID: 1-abc123). It has write permission and contains 5 sections...\"\n\nâš ï¸ CRITICAL: This is the ONLY way to translate notebook names to IDs. All other tools require actual IDs, NOT names.",

	"section_create": "Create a new section in a notebook or section group.\n\nğŸ“ PARAMETERS:\nâ€¢ containerID (optional): Notebook ID or Section Group ID - auto-uses default notebook if blank\nâ€¢ displayName (required): Section display name (must be valid)\n\nâš ï¸ HIERARCHY RULES - CRITICAL:\nâ€¢ Sections can ONLY be created in: Notebooks OR Section Groups\nâ€¢ Sections CANNOT be created inside other sections\nâ€¢ Sections contain pages, not other sections/groups\n\nğŸš« NAME RESTRICTIONS - Cannot contain:\n? * \\ / : < > | & # ' ' % ~\n\nâœ… SUGGESTED ALTERNATIVES:\nâ€¢ & â†’ 'and' (\"Research & Development\" â†’ \"Research and Development\")\nâ€¢ / â†’ '-' (\"Before/After\" â†’ \"Before-After\")\nâ€¢ : â†’ '-' (\"TODO: Items\" â†’ \"TODO - Items\")\nâ€¢ < > â†’ parentheses (\"Important\" â†’ \"(Important)\")\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'Create section in notebook' â†’ sections() â†’ get notebook ID â†’ section_create(notebookID, \"Section Name\")\nâ€¢ 'Create section in group' â†’ sections() â†’ find section group ID â†’ section_create(groupID, \"Sub Section\")\n\nâš ï¸ ERROR HANDLING:\nâ€¢ Illegal characters: Returns \"displayName contains illegal character '[char]'. Suggested valid name: '[suggestion]'\"\nâ€¢ Invalid containerID: Returns \"No containerID provided and failed to get default notebook: [error]\"\nâ€¢ Missing displayName: Returns \"displayName is required\"\nâ€¢ Creation failed: Returns \"Failed to create section: [error details]\"\n\nâš™ï¸ BEHAVIOR: Always validates names and suggests alternatives for illegal characters",

	"section_group_create": "Create a new section group (folder) in a notebook or another section group.\n\nğŸ“ PARAMETERS:\nâ€¢ containerID (optional): Notebook ID or Section Group ID - auto-uses default notebook if blank\nâ€¢ displayName (required): Section group display name (must be valid)\n\nâš ï¸ HIERARCHY RULES - CRITICAL:\nâ€¢ Section Groups can be created in: Notebooks OR other Section Groups\nâ€¢ Section Groups CANNOT be created inside sections\nâ€¢ Section Groups can contain: Sections AND other Section Groups\nâ€¢ Think of them as folders that organize content\n\nğŸš« NAME RESTRICTIONS - Cannot contain:\n? * \\ / : < > | & # ' ' % ~\n\nâœ… SUGGESTED ALTERNATIVES:\nâ€¢ & â†’ 'and' (\"Projects & Ideas\" â†’ \"Projects and Ideas\")\nâ€¢ / â†’ '-' (\"Work/Personal\" â†’ \"Work-Personal\")\nâ€¢ : â†’ '-' (\"Archive: Old\" â†’ \"Archive - Old\")\nâ€¢ < > â†’ parentheses (\"Archive\" â†’ \"(Archive)\")\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'Create main folder' â†’ sections() â†’ get notebook ID â†’ section_group_create(notebookID, \"Main Folder\")\nâ€¢ 'Create sub-folder' â†’ sections() â†’ find parent group ID â†’ section_group_create(parentGroupID, \"Sub Folder\")\n\nâš ï¸ ERROR HANDLING:\nâ€¢ Illegal characters: Returns \"displayName contains illegal character '[char]'. Suggested valid name: '[suggestion]'\"\nâ€¢ Invalid containerID: Returns \"No containerID provided and failed to get default notebook: [error]\"\nâ€¢ Missing displayName: Returns \"displayName is required\"\nâ€¢ Creation failed: Returns \"Failed to create section group: [error details]\"\n\nğŸ  PURPOSE: Hierarchical organization - folders containing sections and other folders",

	"notebook_current": "Get the currently selected notebook's metadata from the server's memory cache.\n\nğŸ“‹ WHAT IT SHOWS: The \"active\" notebook that all other tools operate on by default\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ notebook_current() â†’ shows current selection\nâ€¢ If none selected â†’ notebook_select(ID) to choose one\nâ€¢ After selection â†’ sections() and pages() work on this notebook\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'What notebook am I working with?' â†’ notebook_current() â†’ shows active notebook\nâ€¢ 'Switch to different notebook' â†’ notebooks() â†’ notebook_select(new_ID) â†’ notebook_current() to verify\n\nğŸ“Š RESPONSE FORMAT:\nâ€¢ Full notebook object with ID, displayName, metadata\nâ€¢ Error if no notebook selected (use notebook_select first)\n\nâš™ï¸ SERVER BEHAVIOR:\nâ€¢ Initially set to configured default notebook on startup\nâ€¢ Falls back to first available notebook if no default\nâ€¢ Persists for entire server session\nâ€¢ All section/page operations use this notebook unless explicitly changed",

	"notebook_select": "Select a notebook by name or ID to set as the active notebook context for all subsequent operations.\n\nğŸ¯ PURPOSE: Sets the \"working notebook\" - all sections(), pages(), and page operations will use this notebook\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ notebooks() â†’ find notebook â†’ notebook_select(ID) â†’ sections() â†’ pages()\nâ€¢ After selection â†’ notebook_current() shows active notebook\nâ€¢ All page operations inherit this notebook context\n\nğŸ“ PARAMETERS:\nâ€¢ identifier (required): Notebook name (\"My Work Notebook\") OR notebook ID (\"1-abc123...\")\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'Work with my Project notebook' â†’ notebooks() â†’ find \"Project\" â†’ notebook_select(\"Project\") â†’ sections()\nâ€¢ 'Switch to different notebook' â†’ notebook_select(different_ID) â†’ new context set\n\nâš™ï¸ BEHAVIOR:\nâ€¢ Notebook choice persists for entire server session\nâ€¢ Full metadata cached in memory for fast access\nâ€¢ Authorization validated if enabled (checks permission levels)\n\nâš¡ DISCOVERY PATTERN: Use notebooks() first if unsure of exact name or need the ID\n\nâš ï¸ ERROR HANDLING:\nâ€¢ Notebook not found: Returns \"Failed to find notebook '[identifier]' by name or ID. Use notebooks() to see available notebooks.\"\nâ€¢ Authorization denied: Returns \"Authorization denied: [details]. Check notebook permissions in configuration.\"\nâ€¢ Missing identifier: Returns \"Missing required parameter: identifier (notebook name or ID)\"\nâ€¢ Empty identifier: Returns \"identifier cannot be empty. Provide notebook name or ID.\"",

	"sections": "Shows your notebook's organizational structure - sections and section groups in a tree format. Essential for understanding layout and getting IDs for page operations.\n\nğŸ—ï¸ WHAT IT SHOWS: Tree structure like folders containing subfolders and files\nâ€¢ Section Groups (folders) â†’ can contain sections and other groups\nâ€¢ Sections (files) â†’ contain the actual pages\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ notebook_select(ID) â†’ sections() â†’ see structure â†’ pages(sectionID)\nâ€¢ sections() provides sectionIDs needed for pages(), page_create(), etc.\nâ€¢ Use this BEFORE pages() to find the right sectionID\n\nğŸ“‹ WORKFLOW EXAMPLES:\nâ€¢ 'Show me my notebook structure' â†’ sections() â†’ displays tree with all sections/groups\nâ€¢ 'Find pages in Work section' â†’ sections() â†’ find 'Work' sectionID â†’ pages(sectionID)\nâ€¢ 'Where should I create a page?' â†’ sections() â†’ pick target section â†’ page_create(sectionID)\n\nğŸ“Š RESPONSE FORMAT:\nâ€¢ Notebook root object with displayName, id\nâ€¢ children array containing nested sections and section groups\nâ€¢ Each item has: type, id, name, children (for groups)\nâ€¢ All IDs ready for use in other operations\n\nâš™ï¸ FEATURES:\nâ€¢ Handles pagination automatically (retrieves all results)\nâ€¢ 5-minute memory cache for fast subsequent access\nâ€¢ Progress notifications for large structures\nâ€¢ Hierarchical display shows parent-child relationships\n\nâš ï¸ ERROR HANDLING:\nâ€¢ If no notebook selected: Returns \"No notebook is currently selected. Use notebook_select tool to select a notebook first.\"\nâ€¢ If notebook has no sections: Returns empty children array with message \"No sections found in this notebook\"\nâ€¢ If API fails: Returns \"Failed to fetch sections: [error details]\" with troubleshooting suggestions",

	"cache_clear": "Clear all cached data to force fresh API retrieval. Use when stale data is suspected or to force fresh data retrieval.\n\nğŸ’¾ WHAT GETS CLEARED:\nâ€¢ Notebook sections tree structure (forces fresh sections() calls)\nâ€¢ Page metadata for all sections (forces fresh pages() calls) \nâ€¢ Page search results cache (for quicknote and page finding)\nâ€¢ Notebook lookup cache (for name-to-ID resolution)\n\nğŸ’¾ WHAT STAYS UNCHANGED:\nâ€¢ Currently selected notebook context\nâ€¢ Authentication tokens and session\nâ€¢ Configuration settings\nâ€¢ Server state\n\nğŸ”„ WORKFLOW EXAMPLE:\nUser: \"My changes aren't showing up\"\nâ†’ Step 1: cache_clear â†’ clears all cached data\nâ†’ Step 2: sections() â†’ fetches fresh structure from API\nâ†’ Step 3: pages(sectionID) â†’ fetches fresh page list\n\nâš™ï¸ USE WHEN:\nâ€¢ Stale data suspected (changes not appearing)\nâ€¢ Made changes outside this MCP server\nâ€¢ Troubleshooting cache-related issues\nâ€¢ Want to ensure most up-to-date information\n\nâœ… RESULT: Next sections() and pages() calls will fetch fresh data from Microsoft Graph API and rebuild cache automatically.",

	"pages": "âš ï¸ CRITICAL: sectionID must be an actual ID (e.g., '0-abc123...'), NEVER a section name.\n\nğŸ“ PARAMETERS:\nâ€¢ sectionID (required): Actual section ID from sections() tool - NOT section name\nâ€¢ Example: \"0-abc123def456\" âœ“ vs \"Work Section\" âœ—\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ sections() â†’ find section ID â†’ pages(sectionID) â†’ get page list\nâ€¢ pages() provides pageIDs needed for page_content(), page_update(), etc.\nâ€¢ NEVER assume IDs are known - always use discovery pattern\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'Show pages in Work section' â†’ sections() â†’ find 'Work' sectionID â†’ pages(sectionID)\nâ€¢ 'Get latest page from X' â†’ pages(sectionID) â†’ sort by lastModifiedDateTime â†’ page_content(mostRecentPageID)\nâ€¢ 'List all pages' â†’ sections() â†’ for each section â†’ pages(sectionID)\n\nğŸ“Š RESPONSE FORMAT:\nâ€¢ JSON array of page objects with:\nâ€¢ pageID: Use for page_content(), page_update(), page_delete()\nâ€¢ title: Page display name\nâ€¢ createdDateTime: When page was created\nâ€¢ lastModifiedDateTime: When page was last updated\nâ€¢ Additional metadata and links\n\nâš™ï¸ FEATURES:\nâ€¢ Cached results for fast subsequent access\nâ€¢ Progress notifications for large sections\nâ€¢ Authorization filtering applied automatically\n\nâš ï¸ ERROR HANDLING:\nâ€¢ Invalid sectionID: Returns \"Section not found: [sectionID]. Use sections() to get valid section IDs.\"\nâ€¢ Section name used: Returns \"sectionID must be actual ID, not section name. Use sections() first.\"\nâ€¢ No notebook selected: Returns \"No notebook selected. Use notebook_select first.\"\nâ€¢ Empty section: Returns \"No pages found in the specified section. The section may be empty or you may need to create pages first.\"\nâ€¢ API failure: Returns \"Failed to list pages: [error details]\" with retry suggestions",

	"page_content": "Get OneNote page content in multiple formats with flexible output options.\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Page ID from pages() tool (e.g., \"1-abc123def456\")\nâ€¢ format (optional): Choose output format\n  - 'HTML' (default): Full OneNote formatting, images, structure\n  - 'Markdown': Clean Markdown conversion from HTML\n  - 'Text': Plain text with minimal formatting\nâ€¢ forUpdate (optional): 'true' = adds data-id attributes (HTML only)\n\nâš ï¸ IMPORTANT RESTRICTIONS:\nâ€¢ forUpdate ONLY works with HTML format (needed for updates)\nâ€¢ Markdown/Text formats cannot use forUpdate=true\nâ€¢ Only HTML includes data-id attributes for page_update_advanced\n\nğŸ”„ USAGE EXAMPLES:\nâ€¢ Read content: page_content(pageID, format='Markdown')\nâ€¢ Prepare for updates: page_content(pageID, forUpdate=true, format='HTML')\nâ€¢ Get plain text: page_content(pageID, format='Text')\nâ€¢ Default: page_content(pageID) â†’ returns HTML\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ pages(sectionID) â†’ get pageID â†’ page_content(pageID)\nâ€¢ page_content(forUpdate=true) â†’ page_update_advanced()\nâ€¢ page_content() â†’ analyze content â†’ page_update() for full replacement\n\nğŸ“Š RESPONSE FORMAT: JSON with content, format, lengths, conversion details\n\nâš ï¸ ERROR HANDLING:\nâ€¢ Invalid pageID: Returns \"Page not found: [pageID]. Use pages() to get valid page IDs.\"\nâ€¢ Invalid format: Returns \"Invalid format '[format]'. Valid formats are: HTML, Markdown, Text\"\nâ€¢ forUpdate with non-HTML: Returns \"forUpdate parameter can only be used with HTML format (for page updates)\"\nâ€¢ Page access denied: Returns \"Access denied: page belongs to different notebook than selected\"\nâ€¢ Conversion failure: Returns \"Failed to convert content to [format]: [error details]\"",

	"page_create": "Create a new page in a section with content in ANY format. âš ï¸ DO NOT CONVERT CONTENT - tool handles all format conversion automatically.\n\nğŸ“ PARAMETERS:\nâ€¢ sectionID (required): Section ID from sections() tool (e.g., \"0-abc123def456\")\nâ€¢ title (required): Page title (must be valid)\nâ€¢ content (required): Page content - pass exactly as provided by user\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'Create page with Markdown' â†’ page_create(sectionID, \"My Page\", \"# Header\\n- Item 1\")\nâ€¢ 'Create page with plain text' â†’ page_create(sectionID, \"Notes\", \"This is my note\")\nâ€¢ 'Create page with HTML' â†’ page_create(sectionID, \"Formatted\", \"<h1>Title</h1>\")\n\nğŸš« TITLE RESTRICTIONS - Cannot contain:\n? * \\ / : < > | & # ' ' % ~\n\nâœ… SUGGESTED ALTERNATIVES:\nâ€¢ & â†’ 'and' â€¢ / â†’ '-' â€¢ : â†’ '-' â€¢ < > â†’ parentheses\n\nâš¡ CRITICAL RULES:\nâ€¢ Pass content EXACTLY as user provided - no conversion\nâ€¢ Tool automatically detects format (Markdown/HTML/Text)\nâ€¢ Tool handles ALL conversion internally\nâ€¢ Trust the automatic processing\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ sections() â†’ find sectionID â†’ page_create(sectionID, title, content)\nâ€¢ page_create() â†’ returns pageID â†’ page_content(pageID) to verify\n\nğŸ“Š RESPONSE: Success status, pageID, detected format, conversion details",

	"page_update_advanced": "Update specific elements in a OneNote page using precise command-based targeting. âš ï¸ DO NOT CONVERT CONTENT - tool handles all format conversion automatically.\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Page ID from pages() tool\nâ€¢ commands (required): JSON string with array of command objects\nâ€¢ Each command content accepts: Raw Markdown, Plain text, or HTML as-is\n\nğŸ”„ COMPLETE STEP-BY-STEP EXAMPLE:\n1. Get page with IDs: page_content(\"1-abc123def456\", forUpdate=true)\n2. Response shows HTML like: \"<div data-id='element-789'>Old content</div><h1 data-id='title-123'>Old Title</h1>\"\n3. Identify targets: title-123 for header, element-789 for content\n4. Build commands array:\n   [\n     {\"target\": \"data-id:title-123\", \"action\": \"replace\", \"content\": \"# Updated Title\"},\n     {\"target\": \"data-id:element-789\", \"action\": \"replace\", \"content\": \"New paragraph content\"}\n   ]\n5. Execute: page_update_advanced(\"1-abc123def456\", JSON.stringify(commands))\n6. Result: Title becomes \"Updated Title\", content becomes \"New paragraph content\"\n\nğŸ¯ TARGETING OPTIONS:\nâ€¢ data-id: \"data-id:element-123\" (most precise - from forUpdate=true)\nâ€¢ title: \"title\" (targets page title)\nâ€¢ element: \"h1\", \"p:first\", \"table\" (CSS-like selectors)\nâ€¢ body: \"body\" (main content area)\n\nâš™ï¸ COMMAND ACTIONS:\nâ€¢ replace: Replace target element completely\nâ€¢ append: Add content after target element\nâ€¢ insert: Add content at position (after/before/inside)\nâ€¢ delete: Remove target element entirely\n\nğŸ“ REAL COMMAND EXAMPLES:\n```json\n[\n  {\"target\": \"title\", \"action\": \"replace\", \"content\": \"Meeting Notes - January 15\"},\n  {\"target\": \"body\", \"action\": \"append\", \"content\": \"## Action Items\\n- Review proposal\\n- Schedule follow-up\"},\n  {\"target\": \"data-id:p{53C6BDCC-5F3D-4F5E-8F7E-1234567890AB}{15}\", \"action\": \"insert\", \"content\": \"**Important:** \", \"position\": \"before\"}\n]\n```\n\nâš ï¸ ERROR CASES:\nâ€¢ No forUpdate=true: Returns \"Cannot find target elements without data-id attributes\"\nâ€¢ Invalid target: Returns \"Target 'data-id:missing-element' not found in page\"\nâ€¢ Invalid JSON: Returns \"Failed to parse commands JSON\"\n\nâš ï¸ TABLE RESTRICTION: Update tables as complete units only - cannot modify individual cells\n\nâš¡ CRITICAL: Pass content exactly as provided - tool handles ALL format conversion automatically\n\nğŸ“Š RESPONSE: Success status, commands processed, format detection results per command",

	"page_delete": "Delete a OneNote page permanently. This action CANNOT be undone.\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Page ID from pages() tool (e.g., \"1-abc123def456\")\n\nâš ï¸ CRITICAL WARNING: PERMANENT DELETION - NO RECOVERY POSSIBLE\nâ€¢ Once deleted, page and all content are gone forever\nâ€¢ Always verify correct pageID before proceeding\nâ€¢ Consider asking user for confirmation\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'Delete specific page' â†’ pages(sectionID) â†’ find pageID â†’ confirm with user â†’ page_delete(pageID)\nâ€¢ 'Remove old page' â†’ page_content(pageID) â†’ verify it's correct page â†’ page_delete(pageID)\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ pages(sectionID) â†’ find target pageID â†’ page_delete(pageID)\nâ€¢ page_content(pageID) â†’ verify page contents â†’ page_delete(pageID)\n\nğŸ“Š RESPONSE: Simple success confirmation message\n\nâš™ï¸ BEHAVIOR: Clears page caches automatically after deletion",

	"page_item_content": "Get a page item (image, file) by ID. Returns binary data with proper MIME type.\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Page ID from pages() tool\nâ€¢ pageItemID (required): Item ID from page_items() tool\nâ€¢ filename (optional): Custom filename for download\nâ€¢ fullSize (optional): 'true' = original size, 'false' = scaled to 1024x768 max\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ page_items(pageID) â†’ find pageItemID â†’ page_item_content(pageID, pageItemID)\n\nğŸ“Š RESPONSE: Binary data with proper MIME type, filename, and size information",

	"page_items": "List all items (images, files, attachments) on a specific page.\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Page ID from pages() tool\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ pages(sectionID) â†’ find pageID â†’ page_items(pageID) â†’ page_item_content(pageID, itemID)\n\nğŸ“Š RESPONSE: JSON array with pageItemID, tagName, type, data-attachment info",

	"page_copy": "Copy a page from one section to another, creating a duplicate.\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Source page ID to copy\nâ€¢ targetSectionID (required): Destination section ID\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ pages(sectionID) â†’ find source pageID â†’ sections() â†’ find target sectionID â†’ page_copy(pageID, targetSectionID)\n\nâš™ï¸ BEHAVIOR: Creates exact duplicate in target section, original remains unchanged",

	"page_move": "Move a page from one section to another (copy + delete original).\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Source page ID to move\nâ€¢ targetSectionID (required): Destination section ID\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ pages(sectionID) â†’ find source pageID â†’ sections() â†’ find target sectionID â†’ page_move(pageID, targetSectionID)\n\nâš™ï¸ BEHAVIOR: Copies page to target, then deletes original - net result is page relocation",

	"quick_note": "QUICK NOTE TAKING: Instantly add notes to OneNote with automatic timestamps. Perfect for 'add this as a quick note' requests.\n\nğŸ¯ PRIMARY USE: When user says 'add this as a quick note', 'jot this down', 'save this note quickly', or 'add to my notes'\n\nğŸ“ PARAMETERS:\nâ€¢ content (required): Note content - pass exactly as provided (Markdown/Text/HTML)\n\nâš¡ INSTANT WORKFLOW:\nâ€¢ Automatically finds your configured QuickNote page\nâ€¢ Adds timestamp header (e.g., 'January 15, 2025 - 2:30 PM')\nâ€¢ Appends your content below the timestamp\nâ€¢ No need to specify notebook or page - all automatic\n\nğŸ”„ EXAMPLE USAGE:\nUser: 'Add this as a quick note: Remember to review the proposal'\nâ†’ quick_note('Remember to review the proposal')\nâ†’ Automatically appends to configured page with timestamp\n\nâš™ï¸ CONFIGURATION REQUIRED:\nâ€¢ quicknote.page_name: Target page name (e.g., 'Daily Notes')\nâ€¢ quicknote.notebook_name: Target notebook (optional - uses default)\nâ€¢ quicknote.date_format: Timestamp format (optional)\n\nğŸ¯ KEYWORDS: quick note, add note, jot down, save note, rapid notes, note taking, add this, quick add",

	"page_update": "Replace the entire content of a page with new content in ANY format. âš ï¸ DO NOT CONVERT CONTENT - tool handles all format conversion automatically.\n\nğŸ“ PARAMETERS:\nâ€¢ pageID (required): Page ID from pages() tool (e.g., \"1-abc123def456\")\nâ€¢ content (required): New page content - pass exactly as provided by user\n\nğŸ¯ USE CASE: Complete page content replacement (entire page overwrite)\n\nğŸ”„ WORKFLOW EXAMPLES:\nâ€¢ 'Update with Markdown' â†’ page_update(pageID, \"# New Header\\n- Updated item\")\nâ€¢ 'Update with plain text' â†’ page_update(pageID, \"Updated content here\")\nâ€¢ 'Update with HTML' â†’ page_update(pageID, \"<h1>New Title</h1><p>Content</p>\")\n\nâš¡ CRITICAL RULES:\nâ€¢ Pass content EXACTLY as user provided - no conversion\nâ€¢ Tool automatically detects format (Markdown/HTML/Text)\nâ€¢ Tool handles ALL conversion internally\nâ€¢ Trust the automatic processing\n\nğŸ”— TOOL CONNECTIONS:\nâ€¢ pages(sectionID) â†’ find pageID â†’ page_update(pageID, newContent)\nâ€¢ For partial updates: use page_update_advanced instead\nâ€¢ page_update() â†’ page_content(pageID) to verify changes\n\nğŸ“Š RESPONSE: Success status, detected format, conversion details",
}

// GetToolDescription returns the description for a specific tool
func GetToolDescription(toolName string) (string, error) {
	desc, exists := toolDescriptions[toolName]
	if !exists {
		return "", fmt.Errorf("description not found for tool: %s", toolName)
	}
	return desc, nil
}

// MustGetToolDescription returns the description for a tool or panics if not found
// This should only be used during server initialization where we want to fail fast
func MustGetToolDescription(toolName string) string {
	desc, exists := toolDescriptions[toolName]
	if !exists {
		panic(fmt.Sprintf("Tool description not found: %s", toolName))
	}
	return desc
}

// GetAllDescriptions returns all available tool descriptions
func GetAllDescriptions() map[string]string {
	// Return a copy to prevent modification of the original map
	result := make(map[string]string, len(toolDescriptions))
	for k, v := range toolDescriptions {
		result[k] = v
	}
	return result
}
